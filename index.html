
      //const CLIENT_ID = '70525360510-dj1i0l7v2fekf44no3no6rasthmp9t8v.apps.googleusercontent.com';
      //const API_KEY = 'AIzaSyC3n_SczmI9jZWrEqBgkLEMcDMjiMvOca8';
<!DOCTYPE html>
<html>
<head>
  <title>Acceder a Google Sheets desde HTML</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: 'AIzaSyC3n_SczmI9jZWrEqBgkLEMcDMjiMvOca8', // Reemplaza con tu clave de API
        clientId: '70525360510-dj1i0l7v2fekf44no3no6rasthmp9t8v.apps.googleusercontent.com', // Reemplaza con tu ID de cliente
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
        scope: 'https://www.googleapis.com/auth/spreadsheets'
      }).then(function () {
        // Escucha los cambios en el estado de autenticación.
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);

        // Carga el estado de autenticación actual.
        updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      });
    }

    function updateSignInStatus(isSignedIn) {
      if (isSignedIn) {
        // El usuario ha iniciado sesión, puedes acceder a la hoja de cálculo.
        leerHojaDeCalculo();
      } else {
        // El usuario no ha iniciado sesión, muestra el botón de inicio de sesión.
        $('#signin-button').click(function() {
          gapi.auth2.getAuthInstance().signIn();
        });
      }
    }

    function leerHojaDeCalculo() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: '1Ap0ao7g5X6YN86vTq5Yng3YD9uiqmN9Wv93lR_DDnUM', // Reemplaza con el ID de tu hoja de cálculo
        range: 'Lista!A:F' // Reemplaza con el rango de celdas que deseas leer
      }).then(function(response) {
        var values = response.result.values;
        if (values && values.length > 0) {
          // Itera sobre los datos y haz lo que necesites.
          for (var i = 0; i < values.length; i++) {
            var row = values[i];
            console.log(row[0] + ', ' + row[1]);
          }
        } else {
          console.log('No se encontraron datos.');
        }
      }, function(response) {
        console.error('Error: ' + response.result.error.message);
      });
    }

    function modificarHojaDeCalculo() {
      gapi.client.sheets.spreadsheets.values.update({
        spreadsheetId: '1Ap0ao7g5X6YN86vTq5Yng3YD9uiqmN9Wv93lR_DDnUM', // Reemplaza con el ID de tu hoja de cálculo
        range: 'Lista!A:F', // Reemplaza con el rango de celdas que deseas modificar
        valueInputOption: 'USER_ENTERED',
        resource: {
          values: [['Nuevo valor 1', 'Nuevo valor 2'], ['Nuevo valor 3', 'Nuevo valor 4']] // Reemplaza con los nuevos valores
        }
      }).then(function(response) {
        console.log('Hoja de cálculo modificada.');
      }, function(response) {
        console.error('Error: ' + response.result.error.message);
      });
    }
  </script>
</head>
<body>
  <button id="signin-button">Iniciar sesión con Google</button>
  <script async defer src="https://apis.google.com/js/api:client:auth2"
    onload="this.onload=function(){};handleClientLoad()"
    onerror="this.onerror=function(){};handleClientLoad()"></script>
</body>
</html>
